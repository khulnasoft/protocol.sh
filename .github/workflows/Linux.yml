name: Linux
on:
  push:
    branches:
      - '*'
    paths:
      - '*.sh'
      - '.github/workflows/Linux.yml'

  pull_request:
    branches:
      - dev
    paths:
      - '*.sh'
      - '.github/workflows/Linux.yml'


concurrency: 
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true




jobs:
  Linux:
    strategy:
      matrix:
        os: ["ubuntu:latest", "debian:latest", "almalinux:latest", "fedora:latest", "opensuse/leap:latest", "alpine:latest", "oraclelinux:8", "kalilinux/kali", "archlinux:latest", "mageia", "gentoo/stage3"]
    runs-on: ubuntu-latest
    env:
      TEST_LOCAL: 1
      TEST_PREFERRED_CHAIN: (STAGING)
      TEST_PROTOCOL_Server: "LetsEncrypt.org_test"
    steps:
    - uses: actions/checkout@v4
    - name: Clone protocol.sh
      run: |
          cd .. \
          && git clone -b protocoltest --depth=1 https://github.com/khulnasoft/protocol.sh protocoltest \
          && cp -r protocol.sh protocol.sh/
    - name: Run protocol.sh
      run: |
          cd ../protocol.sh \
          && ./rundocker.sh  testplat ${{ matrix.os }}



